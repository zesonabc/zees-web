<style>
    /* 简单的网格布局，自动适应屏幕 */
    .grid-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* 每个卡片最小300px */
        gap: 20px; /* 卡片之间的间距 */
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    /* 卡片通用样式 */
    .card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        transition: transform 0.2s;
    }
    .card:hover {
        transform: translateY(-5px);
    }

    /* 第一个“添加卡片”的特殊样式 */
    .add-card {
        border: 2px dashed #007bff; /* 虚线边框表示添加 */
        background: #f8f9fa;
        justify-content: center; /* 内容居中 */
    }

    /* 输入框样式微调，让它在小卡片里不溢出 */
    .form-group input, .form-group textarea {
        width: 100%;
        margin-bottom: 10px;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box; /* 防止边框撑大宽度 */
    }
    
    .btn-submit {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px;
        width: 100%;
        border-radius: 4px;
        cursor: pointer;
    }
</style>

<div class="grid-container">

    <div class="card add-card">
        <h3 style="text-align:center; color:#007bff; margin-top:0;">+ 添加新软件</h3>
        <form method="post" enctype="multipart/form-data"> <div class="form-group">
                <input type="text" name="title" placeholder="软件标题" required>
            </div>
            <div class="form-group">
                <input type="text" name="link" placeholder="网盘链接 (https://...)" required>
            </div>
            <div class="form-group">
                <input type="text" name="bilibili" placeholder="B站 BV号 (选填)">
            </div>
            <div class="form-group">
                <textarea name="desc" placeholder="描述文案..." rows="3"></textarea>
            </div>
            <button type="submit" class="btn-submit">发布</button>
        </form>
    </div>

    <?php 
    // 读取数据
    $file = 'data.json';
    $data = file_exists($file) ? json_decode(file_get_contents($file), true) : [];
    
    // 倒序循环，这样原来的逻辑不用变
    if($data):
        $total = count($data);
        foreach(array_reverse($data) as $index => $item): 
            $realIndex = $total - $index; // 修正序号显示
    ?>
        <div class="card">
            <div style="font-weight:bold; font-size:1.2em; margin-bottom:10px;">
                #<?php echo $realIndex; ?> - <?php echo htmlspecialchars($item['title']); ?>
            </div>
            
            <p style="color:#666; font-size:0.9em;">
                <?php echo htmlspecialchars($item['desc']); ?>
            </p>

            <div style="margin-top:10px;">
                <a href="<?php echo htmlspecialchars($item['link']); ?>" target="_blank" style="color:#007bff; text-decoration:none;">网盘链接 &rarr;</a>
            </div>
            
            <div style="margin-top:15px; border-top:1px solid #eee; padding-top:10px; text-align:right;">
                <form method="post" style="display:inline;">
                    <input type="hidden" name="delete_id" value="<?php echo $item['id']; ?>">
                    <button type="submit" style="color:red; background:none; border:none; cursor:pointer;">删除</button>
                </form>
            </div>
        </div>
    <?php 
        endforeach; 
    endif; 
    ?>

</div>
